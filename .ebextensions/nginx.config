files:
  "/etc/nginx/conf.d/01_proxy.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      client_max_body_size 20M;
      proxy_buffer_size 256k;
      proxy_buffers 4 256k;
      proxy_busy_buffers_size 256k;
      
      upstream nodejs {
          server 127.0.0.1:5000;
          keepalive 256;
      }
      
      # Remove any restrictive location blocks
      # All traffic goes through the proxy below

container_commands:
  01_reload_nginx:
    command: "sudo service nginx reload"
    ignoreErrors: true
